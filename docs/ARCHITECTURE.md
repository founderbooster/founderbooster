# FounderBooster Architecture

This document explains the high-level architecture and traffic flow used by FounderBooster.
It focuses on security boundaries, DNS ownership, and how Cloudflare Tunnel proxies traffic
to local services without exposing inbound ports.

```text

                    ┌──────────────────────────────┐
                    │          User Browser        │
                    │  https://demo.example.com    │
                    └──────────────┬───────────────┘
                                   │ HTTPS
                                   ▼
                    ┌──────────────────────────────┐
                    │        Public DNS Layer      │
                    │   (Domain at GoDaddy)        │
                    │   NS → Cloudflare            │
                    └──────────────┬───────────────┘
                                   │
                                   ▼
        ┌────────────────────────────────────────────────┐
        │                Cloudflare Edge                 │
        │  • DNS (Orange-cloud proxy ON)                 │
        │  • TLS certs (auto-provisioned)                │
        │  • WAF / DDoS / Rate-Limit                     │
        │  • Optional: Cloudflare Access                 │
        └──────────────┬─────────────────────────────────┘
                       │ Encrypted HTTPS (Full / Strict)
                       ▼
        ┌────────────────────────────────────────────────┐
        │             Cloudflare Global Network          │
        │        (No traffic hits your public IP)        │
        └──────────────┬─────────────────────────────────┘
                       │ Outbound-only tunnel connection
                       ▼
        ┌────────────────────────────────────────────────┐
        │        Cloudflare Tunnel (cloudflared)         │
        │        • Runs on FounderBooster host           │
        │        • Initiates outbound connection         │
        │        • No inbound ports open                 │
        └──────────────┬─────────────────────────────────┘
                       │ localhost routing
                       ▼
 ┌───────────────────────────────────────────────────────────────┐
 │              FounderBooster Home-Lab / Local LAN              │
 │                                                               │
 │   demo.example.com  ──▶  http://localhost:3000  (Web UI)      │
 │   api.example.com   ──▶  http://localhost:8000  (API)         │
 │   admin.example.com ──▶  http://localhost:8080  (Admin/Tools) │
 │                                                               │
 │   ┌──────────────┐     ┌──────────────┐     ┌──────────────┐  │
 │   │ Web / Next.js│     │ API Service  │     │ Admin / Ops  │  │
 │   └──────┬───────┘     └──────┬───────┘     └──────┬───────┘  │
 │          │                    │                    │          │
 │          ▼                    ▼                    ▼          │
 │       ┌───────────────────────────────────────────────────┐   │
 │       │          Local Services (Private Only)            │   │
 │       │   Postgres / Redis / Workers / Queues             │   │
 │       └───────────────────────────────────────────────────┘   │
 └───────────────────────────────────────────────────────────────┘
```

FounderBooster exposes existing local apps to your own domain in seconds — it does not build, host, or own your app.

It orchestrates:
- Cloudflare APIs
- cloudflared runtime
- Docker-based app stacks

It does not run a server.

---

## High-Level Flow

fb bootstrap
→ resolve app/env/domain/ports
→ doctor checks
→ ensure Cloudflare zone
→ ensure tunnel
→ ensure DNS
→ generate cloudflared config
→ run tunnel
→ app runs locally (user- or Docker-managed)

---

## Control Plane vs Data Plane

- Control Plane: FounderBooster CLI
- Data Plane: App repo + containers

FounderBooster is never in the request path; all application traffic flows from Cloudflare to the tunnel and then to
local services.

---

## State Locations

Global machine state:
~/.founderbooster/<app>/<env>/

Contains:
- config.yml
- tunnel.token
- ports.json
- cloudflared.pid

App repos remain unchanged.
All state is machine-local and can be regenerated by re-running `fb bootstrap`.

---

## Failure Handling

Handled cases:
- Missing Cloudflare zone
- Missing tools
- Port conflicts
- Re-running bootstrap

All failures must explain remediation.

---

## Appendix: Threat Model

What this helps protect against:
- No inbound ports or public IP exposure
- Reduced attack surface compared to port forwarding
- TLS handled at the Cloudflare edge
- Internal services not exposed unless explicitly routed

What this does not protect against:
- Application vulnerabilities
- Authentication or authorization flaws
- Compromised developer machines
- Stolen Cloudflare credentials
- Misconfigured Cloudflare settings

Shared responsibility:
- FounderBooster: orchestration and safe defaults
- Cloudflare: edge security and TLS per plan/config
- Operator: app security, host security, account hygiene
